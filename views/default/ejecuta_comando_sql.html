{{extend 'layout.html'}}

<h2>Ejecutor de Consultas SQL</h2>

{{=form.custom.begin}}
<div class="form-group">
    <label for="consulta_sql">Consulta SQL:</label>
    {{=form.custom.widget.consulta_sql}}
</div>
<div class="form-group">
    <label for="max_registros">LÃ­mite de registros:</label>
    {{=form.custom.widget.max_registros}}
</div>
<div class="form-group">
    {{=form.custom.submit}}
</div>
{{=form.custom.end}}

<h4>Consulta ejecutada:</h4>
<pre>{{=consulta_original}}</pre>


{{if error:}}
<div class="alert alert-danger">
    <strong>Error:</strong> {{=error}}
</div>
{{pass}}

{{if total_registros > 0:}}
<div class="alert alert-info">
    Se encontraron {{=total_registros}} registros.
   <a href="{{=URL('exportar_excel')}}" class="btn btn-success">Exportar a Excel</a>
        Exportar a Excel
    </a>
</div>

<div style="overflow-x: auto;">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                {{for col in columns:}}
                <th>{{=col}}</th>
                {{pass}}
            </tr>
        </thead>
        <tbody>
            {{for row in rows:}}
            <tr>
                {{for val in row:}}
                <td>{{=val}}</td>
                {{pass}}
            </tr>
            {{pass}}
        </tbody>
    </table>
</div>


{{pass}}